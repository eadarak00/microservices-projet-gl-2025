<div class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4 lg:p-8">
    <div class="max-w-7xl mx-auto">

        <!-- En-tête principal avec design moderne -->
        <div class="bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-white/20 p-6 lg:p-8 mb-8">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">

                <!-- Titre avec icône et statistiques -->
                <div class="flex items-center space-x-6">
                    <div class="flex items-center space-x-4">
                        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-4 rounded-2xl shadow-lg">
                            <i class="fas fa-user-graduate text-white text-2xl"></i>
                        </div>
                        <div>
                            <h1 class="text-3xl lg:text-4xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent">
                                Gestion des Étudiants
                            </h1>
                            <p class="text-gray-600 mt-1">Gérez efficacement vos étudiants et leurs informations</p>
                        </div>
                    </div>

                    <!-- Statistiques rapides -->
                    <div class="hidden lg:flex items-center space-x-8">
                        <div class="text-center">
                            <div class="text-3xl font-bold text-indigo-600">{{ etudiantsFiltres.length }}</div>
                            <div class="text-sm text-gray-500 uppercase tracking-wider">Étudiants</div>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-emerald-600">{{ classes.length }}</div>
                            <div class="text-sm text-gray-500 uppercase tracking-wider">Classes</div>
                        </div>
                    </div>
                </div>

                <!-- Bouton d'ajout principal -->
                <button (click)="ouvrirModal(false)"
                    class="group relative bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 hover:from-indigo-600 hover:via-purple-600 hover:to-pink-600 text-white px-8 py-4 rounded-2xl font-semibold transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:-translate-y-1 overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                    <div class="relative flex items-center space-x-3">
                        <i class="fas fa-user-plus text-xl group-hover:rotate-90 transition-transform duration-300"></i>
                        <span class="text-lg">Nouvel Étudiant</span>
                    </div>
                </button>
            </div>
        </div>

        <!-- Barre de recherche et filtres avancés -->
        <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg border border-white/30 p-6 mb-8">
            <div class="space-y-6">
                
                <!-- Ligne principale de filtres -->
                <div class="flex flex-col lg:flex-row items-stretch lg:items-center gap-4">

                    <!-- Champ de recherche avec icône -->
                    <div class="relative flex-1 max-w-md">
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400 text-xl"></i>
                        </div>
                        <input type="text" 
                               placeholder="Rechercher par nom, prénom, matricule..."
                               [(ngModel)]="searchTerm" 
                               (input)="filtrerEtudiants()"
                               class="w-full pl-14 pr-12 py-4 bg-white border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md text-lg" />
                        <button *ngIf="searchTerm" 
                                (click)="searchTerm = ''; filtrerEtudiants()"
                                class="absolute inset-y-0 right-0 pr-4 flex items-center text-gray-400 hover:text-gray-600 transition-colors">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Filtre par classe -->
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <i class="fas fa-school text-indigo-500"></i>
                        </div>
                        <select [(ngModel)]="filtreClasse" 
                                (change)="filtrerEtudiants()"
                                class="appearance-none bg-white border-2 border-gray-200 rounded-2xl pl-12 pr-12 py-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 shadow-sm hover:shadow-md min-w-[200px] text-lg font-medium">
                            <option value="">Toutes les classes</option>
                            <option *ngFor="let classe of classes" [value]="classe.id">
                                {{ classe.libelle }}
                            </option>
                        </select>
                        <div class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none">
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </div>
                    </div>

                    <!-- Toggle filtres avancés -->
                    <button (click)="toggleFiltresAvances()"
                            class="flex items-center space-x-2 px-6 py-4 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-2xl font-semibold transition-all duration-200 whitespace-nowrap">
                        <i class="fas fa-sliders-h"></i>
                        <span>Filtres avancés</span>
                        <i [class]="filtresAvancesOuverts ? 'fas fa-chevron-up' : 'fas fa-chevron-down'" 
                           class="transition-transform duration-300"></i>
                    </button>

                    <!-- Indicateur de résultats -->
                    <div class="flex items-center space-x-2 text-gray-600 bg-gray-50 px-4 py-2 rounded-xl">
                        <i class="fas fa-users text-indigo-500"></i>
                        <span class="font-medium">{{ etudiantsFiltres.length }} étudiant(s)</span>
                    </div>
                </div>

                <!-- Filtres avancés (collapsible) -->
                <div [class]="filtresAvancesOuverts ? 'block' : 'hidden'" 
                     class="grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-2xl border-2 border-gray-200 transition-all duration-300">
                    
                    <!-- Tri par -->
                    <div class="relative">
                        <label class="block text-sm font-bold text-gray-700 mb-2">
                            <i class="fas fa-sort mr-2 text-blue-500"></i>
                            Trier par
                        </label>
                        <select [(ngModel)]="triPar" 
                                (change)="filtrerEtudiants()"
                                class="w-full px-4 py-3 bg-white border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 text-base">
                            <option value="nom">Nom (A-Z)</option>
                            <option value="prenom">Prénom (A-Z)</option>
                            <option value="matricule">Matricule</option>
                            <option value="classe">Classe</option>
                        </select>
                    </div>

                    <!-- Ordre de tri -->
                    <div class="relative">
                        <label class="block text-sm font-bold text-gray-700 mb-2">
                            <i class="fas fa-sort-amount-down mr-2 text-green-500"></i>
                            Ordre
                        </label>
                        <select [(ngModel)]="ordreTri" 
                                (change)="filtrerEtudiants()"
                                class="w-full px-4 py-3 bg-white border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 text-base">
                            <option value="asc">Croissant</option>
                            <option value="desc">Décroissant</option>
                        </select>
                    </div>

                    <!-- Bouton reset filtres -->
                    <div class="flex items-end">
                        <button (click)="resetFiltres()"
                                class="w-full px-4 py-3 bg-red-100 hover:bg-red-200 text-red-700 rounded-xl font-semibold transition-all duration-200 flex items-center justify-center space-x-2">
                            <i class="fas fa-undo"></i>
                            <span>Réinitialiser</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vue Desktop - Tableau moderne -->
        <div class="hidden lg:block">
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl border border-white/30 overflow-hidden">
                <table class="min-w-full">
                    <thead>
                        <tr class="bg-gradient-to-r from-gray-50 via-blue-50 to-indigo-50 border-b-2 border-indigo-100">
                            <th class="px-8 py-6 text-left text-sm font-bold text-gray-700 uppercase tracking-wider">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-id-card text-indigo-500 text-lg"></i>
                                    <span>Matricule</span>
                                </div>
                            </th>
                            <th class="px-8 py-6 text-left text-sm font-bold text-gray-700 uppercase tracking-wider">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-user text-blue-500 text-lg"></i>
                                    <span>Nom & Prénom</span>
                                </div>
                            </th>
                            <th class="px-8 py-6 text-left text-sm font-bold text-gray-700 uppercase tracking-wider">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-phone text-emerald-500 text-lg"></i>
                                    <span>Contact</span>
                                </div>
                            </th>
                            <th class="px-8 py-6 text-left text-sm font-bold text-gray-700 uppercase tracking-wider">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-graduation-cap text-purple-500 text-lg"></i>
                                    <span>Classe</span>
                                </div>
                            </th>
                            <th class="px-8 py-6 text-center text-sm font-bold text-gray-700 uppercase tracking-wider">
                                <div class="flex items-center justify-center space-x-3">
                                    <i class="fas fa-cogs text-gray-500 text-lg"></i>
                                    <span>Actions</span>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100">
                        <tr *ngFor="let etudiant of etudiantsFiltres; let i = index"
                            class="hover:bg-gradient-to-r hover:from-blue-50/50 hover:to-indigo-50/50 transition-all duration-300 group"
                            [style.animation-delay.ms]="i * 100">
                            
                            <!-- Matricule -->
                            <td class="px-8 py-6">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 bg-gradient-to-r from-indigo-100 to-purple-100 rounded-xl flex items-center justify-center">
                                        <i class="fas fa-hashtag text-indigo-600"></i>
                                    </div>
                                    <span class="text-lg font-mono text-gray-900 bg-gray-100 px-3 py-1 rounded-lg">
                                        {{ etudiant.matricule || 'N/A' }}
                                    </span>
                                </div>
                            </td>

                            <!-- Nom & Prénom -->
                            <td class="px-8 py-6">
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 bg-gradient-to-r from-blue-400 to-indigo-400 rounded-full flex items-center justify-center text-white font-bold text-lg">
                                        {{ (etudiant.prenom?.charAt(0) || '') + (etudiant.nom?.charAt(0) || '') }}
                                    </div>
                                    <div>
                                        <div class="text-lg font-semibold text-gray-900">{{ etudiant.prenom }} {{ etudiant.nom }}</div>
                                        <div class="text-sm text-gray-500">{{ etudiant.adresse || 'Adresse non renseignée' }}</div>
                                    </div>
                                </div>
                            </td>

                            <!-- Contact -->
                            <td class="px-8 py-6">
                                <div *ngIf="etudiant.telephone" class="flex items-center space-x-3 text-lg text-gray-700">
                                    <i class="fas fa-phone-alt text-emerald-500"></i>
                                    <a [href]="'tel:' + etudiant.telephone" 
                                       class="hover:text-emerald-600 transition-colors font-medium">
                                        {{ etudiant.telephone }}
                                    </a>
                                </div>
                                <div *ngIf="!etudiant.telephone" class="text-gray-400 italic">
                                    Non renseigné
                                </div>
                            </td>

                            <!-- Classe -->
                            <td class="px-8 py-6">
                                <span class="inline-flex items-center px-4 py-2 rounded-2xl text-sm font-bold bg-gradient-to-r from-purple-100 to-pink-100 text-purple-800 border-2 border-purple-200 shadow-sm">
                                    <i class="fas fa-school mr-2"></i>
                                    {{ getClasseLibelle(etudiant.classeId) }}
                                      <!-- {{etudiant.classeId}} -->
                                </span>
                            </td>

                            <!-- Actions -->
                            <td class="px-8 py-6">
                                <div class="flex items-center justify-center space-x-3">
                                    <button (click)="ouvrirModal(true, etudiant)"
                                        class="group/btn p-3 text-emerald-600 hover:text-white hover:bg-emerald-500 rounded-2xl transition-all duration-200 transform hover:scale-110 shadow-lg hover:shadow-xl"
                                        title="Modifier l'étudiant">
                                        <i class="fas fa-edit text-lg"></i>
                                    </button>
                                    <button (click)="supprimer(etudiant.id!)"
                                        class="group/btn p-3 text-red-600 hover:text-white hover:bg-red-500 rounded-2xl transition-all duration-200 transform hover:scale-110 shadow-lg hover:shadow-xl"
                                        title="Supprimer l'étudiant">
                                        <i class="fas fa-trash text-lg"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>

                        <!-- État vide -->
                        <tr *ngIf="etudiantsFiltres.length === 0">
                            <td colspan="5" class="px-8 py-16 text-center">
                                <div class="flex flex-col items-center space-y-6">
                                    <div class="w-24 h-24 bg-gradient-to-r from-gray-100 to-gray-200 rounded-full flex items-center justify-center">
                                        <i class="fas fa-user-slash text-gray-400 text-3xl"></i>
                                    </div>
                                    <div>
                                        <p class="text-2xl font-semibold text-gray-600 mb-2">Aucun étudiant trouvé</p>
                                        <p class="text-lg text-gray-400">Ajoutez votre premier étudiant ou modifiez vos critères de recherche</p>
                                    </div>
                                    <button (click)="ouvrirModal(false)"
                                        class="bg-gradient-to-r from-indigo-500 to-purple-500 text-white px-8 py-3 rounded-2xl font-semibold hover:shadow-lg transition-all duration-200 flex items-center space-x-2">
                                        <i class="fas fa-user-plus"></i>
                                        <span>Ajouter un étudiant</span>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Vue Mobile - Cartes -->
        <div class="lg:hidden space-y-6">
            <div *ngFor="let etudiant of etudiantsFiltres; let i = index"
                class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl border border-white/30 p-6 hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1"
                [style.animation-delay.ms]="i * 100">

                <!-- En-tête de la carte -->
                <div class="flex justify-between items-start mb-6">
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-blue-400 to-indigo-400 rounded-full flex items-center justify-center text-white font-bold text-lg">
                            {{ (etudiant.prenom?.charAt(0) || '') + (etudiant.nom?.charAt(0) || '') }}
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-900">{{ etudiant.prenom }} {{ etudiant.nom }}</h3>
                            <p class="text-sm text-gray-500 font-mono">{{ etudiant.matricule || 'Matricule non défini' }}</p>
                        </div>
                    </div>
                    <span class="inline-flex items-center px-3 py-1 rounded-2xl text-xs font-bold bg-gradient-to-r from-purple-100 to-pink-100 text-purple-800 border-2 border-purple-200">
                        {{ getClasseLibelle(etudiant.classeId) }}
                    </span>
                </div>

                <!-- Informations de l'étudiant -->
                <div class="space-y-4 mb-6">
                    <div class="flex items-center space-x-4 p-3 bg-gray-50 rounded-2xl">
                        <div class="w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center">
                            <i class="fas fa-phone text-emerald-600 text-lg"></i>
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-600">Téléphone</p>
                            <p class="text-lg font-semibold text-gray-900">{{ etudiant.telephone || 'Non renseigné' }}</p>
                        </div>
                    </div>
                    <div class="flex items-start space-x-4 p-3 bg-gray-50 rounded-2xl">
                        <div class="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0 mt-1">
                            <i class="fas fa-map-marker-alt text-blue-600 text-lg"></i>
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-600">Adresse</p>
                            <p class="text-lg font-semibold text-gray-900">{{ etudiant.adresse || 'Non renseignée' }}</p>
                        </div>
                    </div>
                </div>

                <!-- Actions de la carte -->
                <div class="flex justify-between items-center pt-4 border-t-2 border-gray-100">
                    <div class="flex space-x-3">
                        <button (click)="ouvrirModal(true, etudiant)"
                            class="flex items-center space-x-2 px-4 py-3 text-emerald-600 hover:bg-emerald-50 rounded-2xl transition-all duration-200 transform hover:scale-105">
                            <i class="fas fa-edit"></i>
                            <span class="font-semibold">Modifier</span>
                        </button>
                    </div>
                    <button (click)="supprimer(etudiant.id!)"
                        class="p-3 text-red-600 hover:bg-red-50 rounded-2xl transition-all duration-200 transform hover:scale-105">
                        <i class="fas fa-trash text-lg"></i>
                    </button>
                </div>
            </div>

            <!-- État vide mobile -->
            <div *ngIf="etudiantsFiltres.length === 0" class="text-center py-16">
                <div class="flex flex-col items-center space-y-6">
                    <div class="w-20 h-20 bg-gradient-to-r from-gray-100 to-gray-200 rounded-full flex items-center justify-center">
                        <i class="fas fa-user-slash text-gray-400 text-2xl"></i>
                    </div>
                    <div>
                        <p class="text-xl font-semibold text-gray-600 mb-2">Aucun étudiant trouvé</p>
                        <p class="text-gray-400">Ajoutez un étudiant ou modifiez votre recherche</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL MODERNE AJOUT/MODIFICATION -->
<div id="etudiantModal"
    class="fixed inset-0 bg-black/70 backdrop-blur-sm flex justify-center items-center z-50 hidden p-4 transition-all duration-300">
    <div class="bg-white rounded-3xl shadow-2xl w-full max-w-4xl relative transform transition-all duration-300 max-h-[90vh] overflow-y-auto">

        <!-- En-tête du modal -->
        <div class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 rounded-t-3xl p-8 relative overflow-hidden">
            <div class="absolute inset-0 bg-white/10"></div>
            <div class="absolute -top-10 -right-10 w-40 h-40 bg-white/5 rounded-full"></div>
            <div class="absolute -bottom-10 -left-10 w-32 h-32 bg-white/5 rounded-full"></div>

            <div class="relative flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center backdrop-blur-sm">
                        <i class="fas fa-user-graduate text-white text-2xl"></i>
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold text-white mb-1">
                            {{ modeModification ? 'Modifier l\'étudiant' : 'Nouvel étudiant' }}
                        </h3>
                        <p class="text-white/90 text-lg">
                            {{ modeModification ? 'Modifiez les informations de l\'étudiant' : 'Ajoutez un nouvel étudiant à votre établissement' }}
                        </p>
                    </div>
                </div>
                <button (click)="fermerModal()"
                    class="w-12 h-12 bg-white/20 hover:bg-white/30 rounded-2xl flex items-center justify-center transition-all duration-200 group backdrop-blur-sm">
                    <i class="fas fa-times text-white text-xl group-hover:rotate-90 transition-transform duration-200"></i>
                </button>
            </div>
        </div>

        <!-- Corps du modal -->
        <div class="p-8">
            <form [formGroup]="etudiantForm" (ngSubmit)="onSubmit()" class="space-y-8">

                <!-- Grille des champs -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

                    <!-- Matricule -->
                    <div>
                        <label class="flex items-center space-x-3 text-lg font-bold text-gray-700 mb-4">
                            <div class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-id-card text-indigo-600"></i>
                            </div>
                            <span>Matricule</span>
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-hashtag text-gray-400"></i>
                            </div>
                            <input formControlName="matricule" type="text"
                                class="w-full pl-12 pr-6 py-4 bg-gray-50 border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-500 transition-all duration-200 text-lg hover:shadow-lg font-mono"
                                placeholder="Ex: ETU2024001" />
                        </div>
                    </div>

                    <!-- Nom -->
                    <div>
                        <label class="flex items-center space-x-3 text-lg font-bold text-gray-700 mb-4">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-user text-blue-600"></i>
                            </div>
                            <span>Nom</span>
                            <span class="text-red-500 text-xl">*</span>
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-signature text-gray-400"></i>
                            </div>
                            <input formControlName="nom" type="text"
                                class="w-full pl-12 pr-6 py-4 bg-gray-50 border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-500 transition-all duration-200 text-lg hover:shadow-lg"
                                placeholder="Nom de famille" />
                        </div>
                        <div *ngIf="etudiantForm.controls['nom'].touched && etudiantForm.controls['nom'].invalid"
                            class="flex items-center space-x-3 text-red-500 text-base mt-3 bg-red-50 px-4 py-2 rounded-xl">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span class="font-semibold">Le nom est obligatoire</span>
                        </div>
                    </div>

                    <!-- Prénom -->
                    <div>
                        <label class="flex items-center space-x-3 text-lg font-bold text-gray-700 mb-4">
                            <div class="w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-user-tag text-emerald-600"></i>
                            </div>
                            <span>Prénom</span>
                            <span class="text-red-500 text-xl">*</span>
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-user-circle text-gray-400"></i>
                            </div>
                            <input formControlName="prenom" type="text"
                                class="w-full pl-12 pr-6 py-4 bg-gray-50 border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-500 transition-all duration-200 text-lg hover:shadow-lg"
                                placeholder="Prénom" />
                        </div>
                        <div *ngIf="etudiantForm.controls['prenom'].touched && etudiantForm.controls['prenom'].invalid"
                            class="flex items-center space-x-3 text-red-500 text-base mt-3 bg-red-50 px-4 py-2 rounded-xl">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span class="font-semibold">Le prénom est obligatoire</span>
                        </div>
                    </div>

                    <!-- Téléphone -->
                    <div>
                        <label class="flex items-center space-x-3 text-lg font-bold text-gray-700 mb-4">
                            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-phone text-green-600"></i>
                            </div>
                            <span>Téléphone</span>
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-mobile-alt text-gray-400"></i>
                            </div>
                            <input formControlName="telephone" type="tel"
                                class="w-full pl-12 pr-6 py-4 bg-gray-50 border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-500 transition-all duration-200 text-lg hover:shadow-lg"
                                placeholder="Ex: +221 77 123 45 67" />
                        </div>
                    </div>

                    <!-- Classe -->
                    <div>
                        <label class="flex items-center space-x-3 text-lg font-bold text-gray-700 mb-4">
                            <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-graduation-cap text-purple-600"></i>
                            </div>
                            <span>Classe</span>
                            <span class="text-red-500 text-xl">*</span>
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-school text-gray-400"></i>
                            </div>
                            <select formControlName="classeId"
                                class="w-full appearance-none pl-12 pr-12 py-4 bg-gray-50 border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-500 transition-all duration-200 text-lg hover:shadow-lg">
                                <option value="" disabled>-- Sélectionner une classe --</option>
                                <option *ngFor="let classe of classes" [value]="classe.id">
                                    {{ classe.libelle }} ({{ classe.niveau }} - {{ classe.specialite }})
                                </option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none">
                                <i class="fas fa-chevron-down text-gray-400"></i>
                            </div>
                        </div>
                        <div *ngIf="etudiantForm.controls['classeId'].touched && etudiantForm.controls['classeId'].invalid"
                            class="flex items-center space-x-3 text-red-500 text-base mt-3 bg-red-50 px-4 py-2 rounded-xl">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span class="font-semibold">La classe est obligatoire</span>
                        </div>
                    </div>

                    <!-- Adresse -->
                    <div class="lg:col-span-2">
                        <label class="flex items-center space-x-3 text-lg font-bold text-gray-700 mb-4">
                            <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center">
                                <i class="fas fa-map-marker-alt text-orange-600"></i>
                            </div>
                            <span>Adresse</span>
                        </label>
                        <div class="relative">
                            <div class="absolute top-4 left-4 flex items-center pointer-events-none">
                                <i class="fas fa-home text-gray-400"></i>
                            </div>
                            <textarea formControlName="adresse" rows="3"
                                class="w-full pl-12 pr-6 py-4 bg-gray-50 border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-500 transition-all duration-200 text-lg hover:shadow-lg resize-none"
                                placeholder="Adresse complète de l'étudiant..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Zone d'aide -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-2xl border-2 border-blue-100">
                    <div class="flex items-start space-x-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-600 text-xl"></i>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-blue-900 mb-2">
                                <i class="fas fa-lightbulb mr-2"></i>
                                Conseils pour bien remplir
                            </h4>
                            <ul class="text-blue-800 space-y-2 text-base">
                                <li class="flex items-start space-x-2">
                                    <i class="fas fa-check-circle text-blue-600 mt-1 flex-shrink-0"></i>
                                    <span><strong>Matricule :</strong> Code unique d'identification (optionnel, généré automatiquement si vide)</span>
                                </li>
                                <li class="flex items-start space-x-2">
                                    <i class="fas fa-check-circle text-blue-600 mt-1 flex-shrink-0"></i>
                                    <span><strong>Nom & Prénom :</strong> Informations obligatoires pour l'identification</span>
                                </li>
                                <li class="flex items-start space-x-2">
                                    <i class="fas fa-check-circle text-blue-600 mt-1 flex-shrink-0"></i>
                                    <span><strong>Classe :</strong> Obligatoire pour affecter l'étudiant à une classe</span>
                                </li>
                                <li class="flex items-start space-x-2">
                                    <i class="fas fa-check-circle text-blue-600 mt-1 flex-shrink-0"></i>
                                    <span><strong>Contact :</strong> Téléphone et adresse facilitent la communication</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Boutons d'action -->
                <div class="flex flex-col sm:flex-row justify-end space-y-4 sm:space-y-0 sm:space-x-4 pt-6 border-t-2 border-gray-100">
                    <button type="button" (click)="fermerModal()"
                        class="group px-8 py-4 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-2xl font-bold transition-all duration-200 transform hover:scale-105 text-lg">
                        <div class="flex items-center justify-center space-x-3">
                            <i class="fas fa-times group-hover:-translate-x-1 transition-transform duration-200"></i>
                            <span>Annuler</span>
                        </div>
                    </button>
                    <button type="submit" [disabled]="etudiantForm.invalid"
                        [class]="etudiantForm.invalid ? 
                            'opacity-50 cursor-not-allowed bg-gray-300 text-gray-500' : 
                            'group relative bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 hover:from-indigo-600 hover:via-purple-600 hover:to-pink-600 text-white'"
                        class="px-12 py-4 rounded-2xl font-bold transition-all duration-300 transform hover:scale-105 shadow-xl hover:shadow-2xl text-lg overflow-hidden">
                        <div *ngIf="!etudiantForm.invalid"
                            class="absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                        </div>
                        <div class="relative flex items-center justify-center space-x-3">
                            <i [class]="modeModification ? 'fas fa-save' : 'fas fa-user-plus'" 
                               class="group-hover:rotate-12 transition-transform duration-300"></i>
                            <span>{{ modeModification ? 'Mettre à jour' : 'Ajouter l\'étudiant' }}</span>
                        </div>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Intégration de Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Styles CSS additionnels -->
<style>
    /* Animations personnalisées */
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes slideDown {
        from { transform: translateY(-10px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    @keyframes scaleIn {
        from { transform: scale(0.95); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }

    /* Animation d'apparition des éléments */
    .animate-item {
        animation: slideDown 0.6s ease-out both;
    }

    /* Effets au survol */
    .card-hover {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .card-hover:hover {
        transform: translateY(-8px);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    /* Animation des lignes de tableau */
    tbody tr {
        transition: all 0.3s ease;
    }

    tbody tr:hover {
        transform: translateX(8px);
        background: linear-gradient(90deg, rgba(99, 102, 241, 0.05), rgba(139, 92, 246, 0.05));
    }

    /* Animation des avatars */
    .avatar-initial {
        transition: all 0.3s ease;
    }

    .avatar-initial:hover {
        transform: scale(1.1) rotate(5deg);
        box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
    }

    /* Effet de pulsation pour les statistiques */
    .stat-pulse {
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.8; }
    }

    /* Scrollbar personnalisée */
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(to bottom, #6366f1, #8b5cf6);
        border-radius: 10px;
    }

    /* Amélioration des focus */
    input:focus, select:focus, textarea:focus, button:focus {
        outline: none;
        box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    }

    /* Animation des icônes */
    .fas {
        transition: all 0.3s ease;
    }

    .group:hover .fas {
        transform: scale(1.1);
    }

    /* Effet glassmorphism */
    .glass-effect {
        background: rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.18);
    }

    /* Animation pour les filtres */
    .filter-slide {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Responsive design */
    @media (max-width: 768px) {
        .fas {
            font-size: 1rem !important;
        }
        
        .text-2xl .fas {
            font-size: 1.5rem !important;
        }
        
        .text-3xl .fas {
            font-size: 2rem !important;
        }
    }

    /* Animation des badges de classe */
    .class-badge {
        position: relative;
        overflow: hidden;
    }

    .class-badge::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        transition: left 0.5s;
    }

    .class-badge:hover::before {
        left: 100%;
    }

    /* Effet hover pour les liens téléphone */
    a[href^="tel:"] {
        transition: all 0.3s ease;
    }

    a[href^="tel:"]:hover {
        transform: translateX(3px);
        text-decoration: underline;
    }

    /* Animation pour les boutons désactivés */
    button:disabled {
        animation: none !important;
        transform: none !important;
    }

    /* Effet de brillance sur les cartes */
    .shine-effect {
        position: relative;
        overflow: hidden;
    }

    .shine-effect::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transform: rotate(45deg);
        transition: all 0.6s;
        opacity: 0;
    }

    .shine-effect:hover::before {
        animation: shine 1.5s infinite;
    }

    @keyframes shine {
        0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); opacity: 0; }
        50% { opacity: 1; }
        100% { transform: translateX(100%) translateY(100%) rotate(45deg); opacity: 0; }
    }
</style>

<script>
    // Script pour améliorer l'expérience utilisateur
    document.addEventListener('DOMContentLoaded', function () {
        // Animation d'apparition progressive
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function (entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-item');
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        // Observer les cartes et lignes de tableau
        document.querySelectorAll('.card-hover, tr, .bg-white\\/90').forEach(el => {
            observer.observe(el);
        });

        // Animation des compteurs
        function animateCounter(element, target) {
            let current = 0;
            const increment = target / 30;
            const timer = setInterval(() => {
                current += increment;
                element.textContent = Math.floor(current);
                if (current >= target) {
                    element.textContent = target;
                    clearInterval(timer);
                }
            }, 50);
        }

        // Animer les statistiques
        setTimeout(() => {
            document.querySelectorAll('.text-3xl.font-bold').forEach(counter => {
                const target = parseInt(counter.textContent) || 0;
                if (target > 0) {
                    counter.textContent = '0';
                    animateCounter(counter, target);
                }
            });
        }, 500);

        // Effet sur les avatars
        document.querySelectorAll('.avatar-initial').forEach(avatar => {
            avatar.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.1) rotate(5deg)';
            });
            
            avatar.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1) rotate(0deg)';
            });
        });

        // Animation des icônes au chargement
        document.querySelectorAll('.fas').forEach((icon, index) => {
            setTimeout(() => {
                icon.style.animation = 'fadeIn 0.5s ease-in-out';
            }, index * 30);
        });

        // Gestion des filtres avancés
        const toggleButton = document.querySelector('[class*="toggleFiltresAvances"]');
        const filtersPanel = document.querySelector('.filter-slide');
        
        if (toggleButton && filtersPanel) {
            toggleButton.addEventListener('click', function() {
                filtersPanel.classList.toggle('filter-slide');
            });
        }

        // Animation pulsation pour les stats importantes
        setInterval(() => {
            document.querySelectorAll('.text-3xl.font-bold').forEach(stat => {
                stat.classList.add('stat-pulse');
                setTimeout(() => {
                    stat.classList.remove('stat-pulse');
                }, 2000);
            });
        }, 10000);

        // Amélioration des interactions avec les boutons
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('mouseenter', function() {
                const icon = this.querySelector('.fas');
                if (icon && !this.disabled) {
                    icon.style.transform = 'scale(1.2) rotate(10deg)';
                }
            });

            button.addEventListener('mouseleave', function() {
                const icon = this.querySelector('.fas');
                if (icon) {
                    icon.style.transform = 'scale(1) rotate(0deg)';
                }
            });
        });

        // Auto-génération du matricule si non fourni
        const matriculeInput = document.querySelector('input[formControlName="matricule"]');
        if (matriculeInput) {
            matriculeInput.addEventListener('blur', function() {
                if (!this.value) {
                    const year = new Date().getFullYear();
                    const random = Math.floor(Math.random() * 9999).toString().padStart(4, '0');
                    this.placeholder = `ETU${year}${random}`;
                }
            });
        }
    });

    // Fonction utilitaire pour générer un matricule automatique
    function generateMatricule() {
        const year = new Date().getFullYear();
        const random = Math.floor(Math.random() * 9999).toString().padStart(4, '0');
        return `ETU${year}${random}`;
    }

    // Validation en temps réel des champs
    function setupRealTimeValidation() {
        const inputs = document.querySelectorAll('input[formControlName], select[formControlName]');
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                if (this.hasAttribute('required') && !this.value) {
                    this.parentElement.classList.add('border-red-500');
                } else {
                    this.parentElement.classList.remove('border-red-500');
                    this.parentElement.classList.add('border-green-500');
                    setTimeout(() => {
                        this.parentElement.classList.remove('border-green-500');
                    }, 2000);
                }
            });
        });
    }

    // Initialiser la validation
    setTimeout(setupRealTimeValidation, 1000);
</script>
